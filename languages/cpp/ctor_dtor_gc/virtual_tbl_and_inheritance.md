# Virtual Table and Inheritance

## Single-Base Inheritance

Every virtual-contained class has a per-class virtual table.

```cpp
class BaseNoVirtual
{
public:
  void foo() {};
};

class Base {
 public:
  virtual void foo() {};
  virtual void fooNotOverridden() {};
};

class Derived : public Base {
 public:
  void foo() override {};
};

std::cout << "Size of BaseNoVirtual: " << sizeof(BaseNoVirtual) << std::endl;
std::cout << "Size of Base: " << sizeof(Base) << std::endl;
```

The above code would print
```bash
Size of BaseNoVirtual: 1
Size of Base: 8
```

Every class even empty should occupy some mem, hence `BaseNoVirtual` has 1 byte of data.
`Base` is of size 8 bytes (on 64-bit machine) for it has a hidden pointer pointing to a `vtable`.
The 8 bytes is the size of a pointer.

Run with `gdb`: 

* Use gdb `p` to locate pointer addresses of objects:

```
(gdb) p b1
$1 = {_vptr.Base = 0x555555557d48 <vtable for Base+16>}
(gdb) p b2
$2 = {_vptr.Base = 0x555555557d48 <vtable for Base+16>}
(gdb) p d1
$3 = {<Base> = {_vptr.Base = 0x555555557d28 <vtable for Derived+16>}, <No data fields>}
(gdb) p d2
$4 = {<Base> = {_vptr.Base = 0x555555557d28 <vtable for Derived+16>}, <No data fields>}
```
where both `b1` and `b2` share the same virtual table; `d1` and `d2` share the same as well.
The `_vptr` is added an offset $16$ to its corresponding virtual table `vtable`.

Now look at $\text{0x555555557d18}=\text{0x555555557d28}-16$: 
```
(gdb) x/128xb 0x555555557d18
0x555555557d18 <vtable for Derived>:    0x00    0x00    0x00    0x00    0x00    0x00    0x00    0x00
0x555555557d20 <vtable for Derived+8>:  0x58    0x7d    0x55    0x55    0x55    0x55    0x00    0x00
0x555555557d28 <vtable for Derived+16>: 0x7a    0x53    0x55    0x55    0x55    0x55    0x00    0x00
0x555555557d30 <vtable for Derived+24>: 0x6a    0x53    0x55    0x55    0x55    0x55    0x00    0x00
0x555555557d38 <vtable for Base>:       0x00    0x00    0x00    0x00    0x00    0x00    0x00    0x00
0x555555557d40 <vtable for Base+8>:     0x70    0x7d    0x55    0x55    0x55    0x55    0x00    0x00
0x555555557d48 <vtable for Base+16>:    0x5a    0x53    0x55    0x55    0x55    0x55    0x00    0x00
0x555555557d50 <vtable for Base+24>:    0x6a    0x53    0x55    0x55    0x55    0x55    0x00    0x00
0x555555557d58 <typeinfo for Derived>:  0x98    0xec    0xf6    0xf7    0xff    0x7f    0x00    0x00
0x555555557d60 <typeinfo for Derived+8>:        0x30    0x60    0x55    0x55    0x55    0x55    0x00    0x00
0x555555557d68 <typeinfo for Derived+16>:       0x70    0x7d    0x55    0x55    0x55    0x55    0x00    0x00
0x555555557d70 <typeinfo for Base>:     0x08    0xe0    0xf6    0xf7    0xff    0x7f    0x00    0x00
0x555555557d78 <typeinfo for Base+8>:   0x39    0x60    0x55    0x55    0x55    0x55    0x00    0x00
0x555555557d80: 0x01    0x00    0x00    0x00    0x00    0x00    0x00    0x00
0x555555557d88: 0x01    0x00    0x00    0x00    0x00    0x00    0x00    0x00
0x555555557d90: 0x01    0x00    0x00    0x00    0x00    0x00    0x00    0x00
```
where 
* `0x555555557d38 <vtable for Base>` has value `0x0` = `0x00    0x00    0x00    0x00    0x00    0x00`
* `0x555555557d40 <vtable for Base+8>` has value `0x555555557d70` = `0x70    0x7d    0x55    0x55    0x55    0x55`, indicating `_vptr` pointing to `<typeinfo for Base>`
* `0x555555557d48 <vtable for Base+16>` has value `0x55555555535a` = `0x5a    0x53    0x55    0x55    0x55    0x55`, mapping to 
```
(gdb) x/16xb 0x55555555535a 
0x55555555535a <Base::foo()>:   0xf3    0x0f    0x1e    0xfa    0x55    0x48    0x89    0xe5
0x555555555362 <Base::foo()+8>: 0x48    0x89    0x7d    0xf8    0x90    0x5d    0xc3    0x90
```

The content of `0x55555555535a` has the actual instructions of a function, such as below for `Base::foo()`
```
(gdb) x/10i 0x55555555535a
0x55555555535a <Base::foo()>:        endbr64 
0x55555555535e <Base::foo()+4>:      push   %rbp
0x55555555535f <Base::foo()+5>:      mov    %rsp,%rbp
0x555555555362 <Base::foo()+8>:      mov    %rdi,-0x8(%rbp)
0x555555555366 <Base::foo()+12>:     nop
0x555555555367 <Base::foo()+13>:     pop    %rbp
0x555555555368 <Base::foo()+14>:     retq   
0x555555555369:      nop
0x55555555536a <Base::fooNotOverridden()>:   endbr64 
0x55555555536e <Base::fooNotOverridden()+4>: push   %rbp
```

* `0x555555557d50 <vtable for Base+24>` has value `0x55555555536a` = `0x6a    0x53    0x55    0x55    0x55    0x55`, mapping to
```
(gdb) x/16xb 0x55555555536a
0x55555555536a <Base::fooNotOverridden()>:      0xf3    0x0f    0x1e    0xfa    0x55    0x48    0x89    0xe5
0x555555555372 <Base::fooNotOverridden()+8>:    0x48    0x89    0x7d    0xf8    0x90    0x5d    0xc3    0x90
```

Similarly for `Derived`, there are
* `0x555555557d20 <vtable for Derived+8>` has value `0x555555557d58` = `0x58    0x7d    0x55    0x55    0x55    0x55`, indicating its `_vptr` pointing to `0x555555557d58 <typeinfo for Derived>`
* `0x555555557d28 <vtable for Derived+16>` has value `0x55555555537a` = `0x7a    0x53    0x55    0x55    0x55    0x55`, mapping to
```
(gdb) x/16xb 0x55555555537a
0x55555555537a <Derived::foo()>:        0xf3    0x0f    0x1e    0xfa    0x55    0x48    0x89    0xe5
0x555555555382 <Derived::foo()+8>:      0x48    0x89    0x7d    0xf8    0x90    0x5d    0xc3    0x0f
```
* `0x555555557d30 <vtable for Derived+24>` has value `0x55555555536a` = `0x6a    0x53    0x55    0x55    0x55    0x55`, mapping to the base class's `<Base::fooNotOverridden()>`.

For Type information, there are
* `0x555555557d58 <typeinfo for Derived>` has value `0x7ffff7f6ec98` = `0x98    0xec    0xf6    0xf7    0xff    0x7f`, mapping to
```
(gdb) info symbol 0x7ffff7f6ec98
vtable for __cxxabiv1::__si_class_type_info + 16 in section .data.rel.ro of /lib/x86_64-linux-gnu/libstdc++.so.6
```
* `0x555555557d60 <typeinfo for Derived+8>` has value `0x555555556030` = `0x30    0x60    0x55    0x55    0x55    0x55`, mapping to
```
(gdb) info symbol 0x555555556030
typeinfo name for Derived in section .rodata of /home/yuqi/Desktop/KnowledgeNotes/languages/cpp/coding/a.out
```
* `0x555555557d68 <typeinfo for Derived+16>` has value `0x555555557d70` = `0x70    0x7d    0x55    0x55    0x55    0x55`, mapping to
```
(gdb) info symbol 0x555555557d70
typeinfo for Base in section .data.rel.ro of /home/yuqi/Desktop/KnowledgeNotes/languages/cpp/coding/a.out
```
* `0x555555557d78 <typeinfo for Base+8>` has value `0x555555556039` = `0x39    0x60    0x55    0x55    0x55    0x55`, mapping to
```
(gdb) info symbol 0x555555556039
typeinfo name for Base in section .rodata of /home/yuqi/Desktop/KnowledgeNotes/languages/cpp/coding/a.out
```

By now it should be clear that each class has its own `vtable`, non-overridden methods have both base and derived classes pointing to the same addresses.
The pointed functions' addresses contain the actual instructions for CPU to run.
Besides, `typeinfo` records class symbols in ELF format.

## Multiple-Base Inheritance

Given the code below that defines `Derived d;`.

```cpp
class Base1 {
public:
  virtual void Base1Func() {} ;
  int base1Val;
};

class Base2 {
public:
  virtual void Base2Func() {} ;
  int base2Val;
};

class Derived : public Base1, public Base2 {
public:
  virtual void DerivedFunc() {} ;
  int derivedVal;
};
```

By `gdb`, there is
```
(gdb) p d
$1 = {<Base1> = {_vptr.Base1 = 0x555555557cf0 <vtable for Derived+16>, base1Val = 1431655168}, <Base2> = {
    _vptr.Base2 = 0x555555557d10 <vtable for Derived+48>, base2Val = 1431654560}, derivedVal = 21845}
```

The two virtual pointers `_vptr.Base1 = 0x555555557cf0` and `_vptr.Base2 = 0x555555557d10` point to below addresses
```
(gdb) x/16bx 0x555555555248
0x555555555248 <Base1::Base1Func()>:    0xf3    0x0f    0x1e    0xfa    0x55    0x48    0x89    0xe5
0x555555555250 <Base1::Base1Func()+8>:  0x48    0x89    0x7d    0xf8    0x90    0x5d    0xc3    0x90
(gdb) x/16bx 0x555555555258
0x555555555258 <Base2::Base2Func()>:    0xf3    0x0f    0x1e    0xfa    0x55    0x48    0x89    0xe5
0x555555555260 <Base2::Base2Func()+8>:  0x48    0x89    0x7d    0xf8    0x90    0x5d    0xc3    0x90
```
The reason for employing two `vptr`s is that,
in runtime polymorphism such as passing derived class `this` pointer to base class shown as below
```cpp
Derived* d = new Derived();
Base1* b1 = d;
Base2* b2 = d;
```
Since both `Base1` and `Base2` expect the `Derived`'s `this` pointer hold correct offset in its memory layout, 
for both `Base1` and `Base2` do not know the `Derived` memory layout,
Two pointers should be employed rather than one pointer.

If only by one `vptr`, `Base1`'s `vptr` does not know how `Base2`'s memory layout.

Print the memory content $\text{0x555555557ce0}=\text{0x555555557cf0}-16$
```
(gdb) x/256xb 0x555555557ce0
0x555555557ce0 <vtable for Derived>:    0x00    0x00    0x00    0x00    0x00    0x00    0x00    0x00
0x555555557ce8 <vtable for Derived+8>:  0x48    0x7d    0x55    0x55    0x55    0x55    0x00    0x00
0x555555557cf0 <vtable for Derived+16>: 0x48    0x52    0x55    0x55    0x55    0x55    0x00    0x00
0x555555557cf8 <vtable for Derived+24>: 0x68    0x52    0x55    0x55    0x55    0x55    0x00    0x00
0x555555557d00 <vtable for Derived+32>: 0xf0    0xff    0xff    0xff    0xff    0xff    0xff    0xff
0x555555557d08 <vtable for Derived+40>: 0x48    0x7d    0x55    0x55    0x55    0x55    0x00    0x00
0x555555557d10 <vtable for Derived+48>: 0x58    0x52    0x55    0x55    0x55    0x55    0x00    0x00
0x555555557d18 <vtable for Base2>:      0x00    0x00    0x00    0x00    0x00    0x00    0x00    0x00
0x555555557d20 <vtable for Base2+8>:    0x80    0x7d    0x55    0x55    0x55    0x55    0x00    0x00
0x555555557d28 <vtable for Base2+16>:   0x58    0x52    0x55    0x55    0x55    0x55    0x00    0x00
0x555555557d30 <vtable for Base1>:      0x00    0x00    0x00    0x00    0x00    0x00    0x00    0x00
0x555555557d38 <vtable for Base1+8>:    0x90    0x7d    0x55    0x55    0x55    0x55    0x00    0x00
0x555555557d40 <vtable for Base1+16>:   0x48    0x52    0x55    0x55    0x55    0x55    0x00    0x00
0x555555557d48 <typeinfo for Derived>:  0x58    0xed    0xf6    0xf7    0xff    0x7f    0x00    0x00
0x555555557d50 <typeinfo for Derived+8>:        0x08    0x60    0x55    0x55    0x55    0x55    0x00    0x00
0x555555557d58 <typeinfo for Derived+16>:       0x00    0x00    0x00    0x00    0x02    0x00    0x00    0x00
0x555555557d60 <typeinfo for Derived+24>:       0x90    0x7d    0x55    0x55    0x55    0x55    0x00    0x00
0x555555557d68 <typeinfo for Derived+32>:       0x02    0x00    0x00    0x00    0x00    0x00    0x00    0x00
0x555555557d70 <typeinfo for Derived+40>:       0x80    0x7d    0x55    0x55    0x55    0x55    0x00    0x00
0x555555557d78 <typeinfo for Derived+48>:       0x02    0x10    0x00    0x00    0x00    0x00    0x00    0x00
0x555555557d80 <typeinfo for Base2>:    0x08    0xe0    0xf6    0xf7    0xff    0x7f    0x00    0x00
0x555555557d88 <typeinfo for Base2+8>:  0x11    0x60    0x55    0x55    0x55    0x55    0x00    0x00
0x555555557d90 <typeinfo for Base1>:    0x08    0xe0    0xf6    0xf7    0xff    0x7f    0x00    0x00
0x555555557d98 <typeinfo for Base1+8>:  0x18    0x60    0x55    0x55    0x55    0x55    0x00    0x00
0x555555557da0: 0x01    0x00    0x00    0x00    0x00    0x00    0x00    0x00
0x555555557da8: 0x01    0x00    0x00    0x00    0x00    0x00    0x00    0x00
0x555555557db0: 0x01    0x00    0x00    0x00    0x00    0x00    0x00    0x00
```

## Virtual Inheritance

`Derived d` inherits from `class Derived : public Base1, public Base2` that further virtual inherit from `SuperBase`.

```cpp

class SuperBase {
  virtual void SuperBaseFunc() {} ;
  int superBaseVal;
};

class Base1 : virtual public SuperBase {
public:
  virtual void Base1Func() {} ;
  int base1Val;
};

class Base2 : virtual public SuperBase {
public:
  virtual void Base2Func() {} ;
  int base2Val;
};

class Derived : public Base1, public Base2 {
public:
  virtual void DerivedFunc() {} ;
  int derivedVal;
};
```

By gdb querying into `Derived d`, there is
```
(gdb) p d
$1 = {<Base1> = {<SuperBase> = {_vptr.SuperBase = 0x555555557c30 <vtable for Derived+96>, 
      superBaseVal = 1431654560}, _vptr.Base1 = 0x555555557be8 <vtable for Derived+24>, 
    base1Val = 1431655421}, <Base2> = {_vptr.Base2 = 0x555555557c10 <vtable for Derived+64>, 
    base2Val = 1431655344}, derivedVal = 21845}
```

`Derived d` has three `vptr`s.
Now print out the memory starting at $\text{0x555555557bd0} = \text{0x555555557be8}-24$, there is

```
(gdb) x/500xb 0x555555557bd0
0x555555557bd0 <vtable for Derived>:    0x20    0x00    0x00    0x00    0x00    0x00    0x00    0x00
0x555555557bd8 <vtable for Derived+8>:  0x00    0x00    0x00    0x00    0x00    0x00    0x00    0x00
0x555555557be0 <vtable for Derived+16>: 0x08    0x7d    0x55    0x55    0x55    0x55    0x00    0x00
0x555555557be8 <vtable for Derived+24>: 0x58    0x52    0x55    0x55    0x55    0x55    0x00    0x00
0x555555557bf0 <vtable for Derived+32>: 0x78    0x52    0x55    0x55    0x55    0x55    0x00    0x00
0x555555557bf8 <vtable for Derived+40>: 0x10    0x00    0x00    0x00    0x00    0x00    0x00    0x00
0x555555557c00 <vtable for Derived+48>: 0xf0    0xff    0xff    0xff    0xff    0xff    0xff    0xff
0x555555557c08 <vtable for Derived+56>: 0x08    0x7d    0x55    0x55    0x55    0x55    0x00    0x00
0x555555557c10 <vtable for Derived+64>: 0x68    0x52    0x55    0x55    0x55    0x55    0x00    0x00
0x555555557c18 <vtable for Derived+72>: 0x00    0x00    0x00    0x00    0x00    0x00    0x00    0x00
0x555555557c20 <vtable for Derived+80>: 0xe0    0xff    0xff    0xff    0xff    0xff    0xff    0xff
0x555555557c28 <vtable for Derived+88>: 0x08    0x7d    0x55    0x55    0x55    0x55    0x00    0x00
0x555555557c30 <vtable for Derived+96>: 0x48    0x52    0x55    0x55    0x55    0x55    0x00    0x00
0x555555557c38 <VTT for Derived>:       0xe8    0x7b    0x55    0x55    0x55    0x55    0x00    0x00
0x555555557c40 <VTT for Derived+8>:     0x88    0x7c    0x55    0x55    0x55    0x55    0x00    0x00
0x555555557c48 <VTT for Derived+16>:    0xa8    0x7c    0x55    0x55    0x55    0x55    0x00    0x00
0x555555557c50 <VTT for Derived+24>:    0xc8    0x7c    0x55    0x55    0x55    0x55    0x00    0x00
0x555555557c58 <VTT for Derived+32>:    0xe8    0x7c    0x55    0x55    0x55    0x55    0x00    0x00
0x555555557c60 <VTT for Derived+40>:    0x30    0x7c    0x55    0x55    0x55    0x55    0x00    0x00
0x555555557c68 <VTT for Derived+48>:    0x10    0x7c    0x55    0x55    0x55    0x55    0x00    0x00
0x555555557c70 <construction vtable for Base1-in-Derived>:      0x20    0x00    0x00    0x00    0x00    0x00    0x00    0x00
0x555555557c78 <construction vtable for Base1-in-Derived+8>:    0x00    0x00    0x00    0x00    0x00    0x00    0x00    0x00
0x555555557c80 <construction vtable for Base1-in-Derived+16>:   0x68    0x7d    0x55    0x55    0x55    0x55    0x00    0x00
0x555555557c88 <construction vtable for Base1-in-Derived+24>:   0x58    0x52    0x55    0x55    0x55    0x55    0x00    0x00
0x555555557c90 <construction vtable for Base1-in-Derived+32>:   0x00    0x00    0x00    0x00    0x00    0x00    0x00    0x00
0x555555557c98 <construction vtable for Base1-in-Derived+40>:   0xe0    0xff    0xff    0xff    0xff    0xff    0xff    0xff
0x555555557ca0 <construction vtable for Base1-in-Derived+48>:   0x68    0x7d    0x55    0x55    0x55    0x55    0x00    0x00
0x555555557ca8 <construction vtable for Base1-in-Derived+56>:   0x48    0x52    0x55    0x55    0x55    0x55    0x00    0x00
0x555555557cb0 <construction vtable for Base2-in-Derived>:      0x10    0x00    0x00    0x00    0x00    0x00    0x00    0x00
0x555555557cb8 <construction vtable for Base2-in-Derived+8>:    0x00    0x00    0x00    0x00    0x00    0x00    0x00    0x00
0x555555557cc0 <construction vtable for Base2-in-Derived+16>:   0x40    0x7d    0x55    0x55    0x55    0x55    0x00    0x00
0x555555557cc8 <construction vtable for Base2-in-Derived+24>:   0x68    0x52    0x55    0x55    0x55    0x55    0x00    0x00
0x555555557cd0 <construction vtable for Base2-in-Derived+32>:   0x00    0x00    0x00    0x00    0x00    0x00    0x00    0x00
0x555555557cd8 <construction vtable for Base2-in-Derived+40>:   0xf0    0xff    0xff    0xff    0xff    0xff    0xff    0xff
0x555555557ce0 <construction vtable for Base2-in-Derived+48>:   0x40    0x7d    0x55    0x55    0x55    0x55    0x00    0x00
0x555555557ce8 <construction vtable for Base2-in-Derived+56>:   0x48    0x52    0x55    0x55    0x55    0x55    0x00    0x00
0x555555557cf0 <vtable for SuperBase>:  0x00    0x00    0x00    0x00    0x00    0x00    0x00    0x00
0x555555557cf8 <vtable for SuperBase+8>:        0x90    0x7d    0x55    0x55    0x55    0x55    0x00    0x00
0x555555557d00 <vtable for SuperBase+16>:       0x48    0x52    0x55    0x55    0x55    0x55    0x00    0x00
0x555555557d08 <typeinfo for Derived>:  0x58    0xed    0xf6    0xf7    0xff    0x7f    0x00    0x00
0x555555557d10 <typeinfo for Derived+8>:        0x08    0x60    0x55    0x55    0x55    0x55    0x00    0x00
0x555555557d18 <typeinfo for Derived+16>:       0x02    0x00    0x00    0x00    0x02    0x00    0x00    0x00
0x555555557d20 <typeinfo for Derived+24>:       0x68    0x7d    0x55    0x55    0x55    0x55    0x00    0x00
0x555555557d28 <typeinfo for Derived+32>:       0x02    0x00    0x00    0x00    0x00    0x00    0x00    0x00
0x555555557d30 <typeinfo for Derived+40>:       0x40    0x7d    0x55    0x55    0x55    0x55    0x00    0x00
0x555555557d38 <typeinfo for Derived+48>:       0x02    0x10    0x00    0x00    0x00    0x00    0x00    0x00
0x555555557d40 <typeinfo for Base2>:    0x58    0xed    0xf6    0xf7    0xff    0x7f    0x00    0x00
0x555555557d48 <typeinfo for Base2+8>:  0x11    0x60    0x55    0x55    0x55    0x55    0x00    0x00
0x555555557d50 <typeinfo for Base2+16>: 0x00    0x00    0x00    0x00    0x01    0x00    0x00    0x00
0x555555557d58 <typeinfo for Base2+24>: 0x90    0x7d    0x55    0x55    0x55    0x55    0x00    0x00
0x555555557d60 <typeinfo for Base2+32>: 0x03    0xe8    0xff    0xff    0xff    0xff    0xff    0xff
0x555555557d68 <typeinfo for Base1>:    0x58    0xed    0xf6    0xf7    0xff    0x7f    0x00    0x00
0x555555557d70 <typeinfo for Base1+8>:  0x18    0x60    0x55    0x55    0x55    0x55    0x00    0x00
0x555555557d78 <typeinfo for Base1+16>: 0x00    0x00    0x00    0x00    0x01    0x00    0x00    0x00
0x555555557d80 <typeinfo for Base1+24>: 0x90    0x7d    0x55    0x55    0x55    0x55    0x00    0x00
0x555555557d88 <typeinfo for Base1+32>: 0x03    0xe8    0xff    0xff    0xff    0xff    0xff    0xff
0x555555557d90 <typeinfo for SuperBase>:        0x08    0xe0    0xf6    0xf7    0xff    0x7f    0x00    0x00
0x555555557d98 <typeinfo for SuperBase+8>:      0x20    0x60    0x55    0x55    0x55    0x55    0x00    0x00
0x555555557da0: 0x01    0x00    0x00    0x00    0x00    0x00    0x00    0x00
0x555555557da8: 0x01    0x00    0x00    0x00    0x00    0x00    0x00    0x00
```

Below is the memory layout for `Derived`
|Size|Value|
|-|-|
|8 bytes|`_vptr$SuperBase`|
|4 bytes|`superBaseVal`+ 4 bytes of zero padding|
|8 bytes|`_vptr$Base1`|
|4 bytes|`base1Val`+ 4 bytes of zero padding|
|8 bytes|`_vptr$Base2`|
|4 bytes|`base2Val`+ 4 bytes of zero padding|
|4 bytes|`derivedVal`|

It shows that the inheritance is of a diamond shape, only containing one `SuperBase`.
If `Base1` and `Base2` inheritance does not have `virtual`, the `Derived` should have two `SuperBase`.

### `VTT`

`VTT` stands for *virtual-table table*, a table that is used to manage virtual tables.

For example, `0x555555557c38 <VTT for Derived>` got the value `0x555555557be8` = `0xe8    0x7b    0x55    0x55    0x55    0x55` that points to `0x555555557be8 <vtable for Derived+24>` which then points to `0x555555555258 <Base1::Base1Func()>`.
```
(gdb) x/16bx 0x555555557be8
0x555555557be8 <vtable for Derived+24>: 0x58    0x52    0x55    0x55    0x55    0x55    0x00    0x00
0x555555557bf0 <vtable for Derived+32>: 0x78    0x52    0x55    0x55    0x55    0x55    0x00    0x00

(gdb) x/16bx 0x555555555258
0x555555555258 <Base1::Base1Func()>:    0xf3    0x0f    0x1e    0xfa    0x55    0x48    0x89    0xe5
0x555555555260 <Base1::Base1Func()+8>:  0x48    0x89    0x7d    0xf8    0x90    0x5d    0xc3    0x90
```

Similarly, `0x555555557c40 <VTT for Derived+8>` with the value `0x555555557c88` = `0x88    0x7c    0x55    0x55    0x55    0x55`
points to `0x555555557c88 <construction vtable for Base1-in-Derived+24>` that points to `0x555555555258 <Base1::Base1Func()>`
```
(gdb) x/16bx 0x555555557c88
0x555555557c88 <construction vtable for Base1-in-Derived+24>:   0x58    0x52    0x55    0x55    0x55    0x55    0x00    0x00
0x555555557c90 <construction vtable for Base1-in-Derived+32>:   0x00    0x00    0x00    0x00    0x00    0x00    0x00    0x00

(gdb) x/16bx 0x555555555258
0x555555555258 <Base1::Base1Func()>:    0xf3    0x0f    0x1e    0xfa    0x55    0x48    0x89    0xe5
0x555555555260 <Base1::Base1Func()+8>:  0x48    0x89    0x7d    0xf8    0x90    0x5d    0xc3    0x90
```

### `construction vtable`

Construction follows this order: `SuperBase` -> `Base1` and `Base2` -> `Derived`.
Once `SuperBase` finishes construction, `Base1` and `Base2` need to know what access they have for now,
and `construction vtable` is used to tell `Base1` and `Base2` such information.

For example, in `<construction vtable for Base1-in-Derived>`, it allows access to `Base1::Base1Func()` and `SuperBase::SuperBaseFunc()`.

|Addr in Construction Virtual Table|Addr's Value|Addr's Value Meaning/Mapped Content|
|-|-|-|
|`<construction vtable for Base1-in-Derived>`|`0x20`(32)=`0x20    0x00    0x00    0x00    0x00    0x00    0x00    0x00`|virtual-base offset|
|`<construction vtable for Base1-in-Derived+8>`|`0x0`=`0x00    0x00    0x00    0x00    0x00    0x00    0x00    0x00`|top offset|
|`<construction vtable for Base1-in-Derived+16>`|`0x555555557d68`=`0x68    0x7d    0x55    0x55    0x55    0x55    0x00    0x00`|`<typeinfo for Base1>`|
|`<construction vtable for Base1-in-Derived+24>`|`0x555555555258`=`0x58    0x52    0x55    0x55    0x55    0x55    0x00    0x00`|` <Base1::Base1Func()>`|
|`<construction vtable for Base1-in-Derived+32>`|`0x0`=`0x00    0x00    0x00    0x00    0x00    0x00    0x00    0x00`| virtual-base offset|
|`<construction vtable for Base1-in-Derived+40>`|`0xffffffffffe0`(-32)=`0xe0    0xff    0xff    0xff    0xff    0xff    0xff    0xff`| top offset|
|`<construction vtable for Base1-in-Derived+48>`|`0x555555557d68`=`0x68    0x7d    0x55    0x55    0x55    0x55    0x00    0x00`| ` <typeinfo for Base1>`|
|`<construction vtable for Base1-in-Derived+56>`|`0x555555555248`=`0x48    0x52    0x55    0x55    0x55    0x55    0x00    0x00`| ` <SuperBase::SuperBaseFunc()>`|
